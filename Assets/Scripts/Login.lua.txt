---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by DELL.
--- DateTime: 2020/12/16 17:18
---
print("init login")
local username = nil
local password = nil
local tipText = nil

local userdata = require('UserData')
local normalTip = require('NormalTip')
function start()
    username = input_username:GetComponent("InputField")
    password = input_password:GetComponent("InputField")
    btn_login:GetComponent("Button").onClick:AddListener(function()
        if checkAviliable() then
            success()
        else
            normalTip.showTip(tipText)
        end
    end)

    btn_signup:GetComponent("Button").onClick:AddListener(function()
        gotoSignUp()
    end)
end

function gotoSignUp()
    username.text = ""
    password.text = ""
    self.gameObject:SetActive(false)
    page_signup:SetActive(true)
end

function success()
    self.gameObject:SetActive(false)
    page_success:SetActive(true)
end

function checkAviliable()
    if username.text == "" then
        tipText = "用户名为空"
        return false
    end
    if password.text == "" then
        tipText = "密码为空"
        return false
    end

    if not userdata.getUser(username.text) then
        tipText = "用戶不存在"
        return false
    end
    if not userdata.checkUser(username.text,password.text) then
        tipText = "账号或者密码错误"
        return false
    end

    return true
end