---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by DELL.
--- DateTime: 2020/12/16 17:35
---
print("init singnup")
local username = nil
local password01 = nil
local password02 = nil
local tipText = nil

local userdata = require('UserData')
local normalTip = require('NormalTip')

function start()
    username = input_username:GetComponent("InputField")
    password01 = input_password01:GetComponent("InputField")
    password02 = input_password02:GetComponent("InputField")
    btn_back:GetComponent("Button").onClick:AddListener(function()
        close()
    end)

    btn_signup:GetComponent("Button").onClick:AddListener(function()
        if checkAviliable() then
            userdata.addUser(username.text, password01.text)
            close()
        else
            normalTip.showTip(tipText)
        end
    end)
end

function close()
    username.text = ""
    password01.text = ""
    password02.text = ""
    self.gameObject:SetActive(false)
    page_login:SetActive(true)
end

function checkAviliable()
    if username.text == "" then
        tipText = "用户名为空"
        return false
    end

    if password01.text == "" or password02.text == "" then
        tipText = "密码为空"
        return false
    end

    if password01.text ~= password02.text then
        tipText = "密码不一致"
        return false
    end

    if userdata.getUser(username.text) then
        tipText = "用户已存在"
        return false
    end

    return true
end